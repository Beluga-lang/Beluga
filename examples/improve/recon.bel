%{

  Example illustrating that we currently do not reconstruct
  type labels.

}%
exp: type.
lam: (exp -> exp) -> exp.

tp: type.
arr: tp -> tp -> tp.

oft: exp -> tp -> type.
t_lam: ({x:exp} oft x T -> oft (M x) S)
       -> oft (lam M) (arr T S).

schema ctx = exp ;

rec copy : (g:ctx) [g |- exp] -> [g |- exp] =
% / total e (copy g e)/
fn e => case e of
| [h |- lam (\x. M .. x)] =>
  let [h,x:exp |- N .. x] = copy [h, x:exp |- M .. x] in
    [h |- lam \x. N .. x ]
;

