<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Beluga_parser (beluga.Beluga_parser)</title><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">beluga</a> &#x00BB; Beluga_parser</nav><header class="odoc-preamble"><h1>Module <code><span>Beluga_parser</span></code></h1><p>Parsing and disambiguation of Beluga signatures.</p><p>Make sure to familiarize yourself with the <code>beluga-language-specification.tex</code> file which exhaustively details the functional requirements of this parser.</p><p>Parsing of Beluga signatures is implemented in three phases:</p><ol><li>Lexing/tokenization (see <a href="Token/index.html"><code>Token</code></a> and <a href="Lexer/index.html"><code>Lexer</code></a>)</li><li>Context-free parsing (see <a href="Parser_combinator/index.html"><code>Parser_combinator</code></a> and modules with the suffix <code>_parser</code>)</li><li>Context-sensitive disambiguation (see <a href="Disambiguation_state/index.html"><code>Disambiguation_state</code></a> and modules with the suffix <code>_disambiguation</code>)</li></ol><p>The lexing phase converts UTF-8 encoded input files to tokens using the <code>sedlex</code> library (see the <code>dune</code> file for the pre-processing configuration of the <a href="Lexer/index.html"><code>Lexer</code></a> module). Tokenization works like in other programming language implementations, except for a special handling of the dot <code>.</code> operator with the <code>Token.DOT</code>, <code>Token.DOT_IDENT s</code> and <code>Token.DOT_INTLIT i</code> token kinds. See the <a href="Common_parser/index.html"><code>Common_parser</code></a> module for a note on how those tokens are handled.</p><p>The context-free parsing phase is a recursive descent parser implemented with parser combinators and selective unlimited backtracking. This phase handles parsing of static operators, and constructs a parse tree with ambiguous nodes. These ambiguous nodes are qualified and dotted qualified identifiers (which may represent projections instead of references to constants in namespaces), applications (the juxtaposition of terms and user-defined operators), contextual LF substitutions and contexts, and old-style LF declarations (LF type-level and term-level declarations).</p><p>The context-sensitive disambiguation phase is a stateful translation from the parser syntax to the external syntax. The disambiguation state constructs the lexical referencing environment during the traversal so that identifiers and qualified identifiers may be resolved to their binding sites to determine what kind of AST node to produce. Overloading of identifiers is not supported. The disambiguation state is mutable to ensure good performance.</p><ul class="at-tags"><li class="author"><span class="at-tag">author</span> Marc-Atoine Ouimet</li></ul></header><nav class="odoc-toc"><ul><li><a href="#parsing-configuration-files">Parsing Configuration Files</a></li><li><a href="#lexing">Lexing</a></li><li><a href="#parsing">Parsing</a></li><li><a href="#disambiguation">Disambiguation</a></li><li><a href="#constructors_4">Constructors</a></li><li><a href="#instances_10">Instances</a></li></ul></nav><div class="odoc-content"><h2 id="parsing-configuration-files"><a href="#parsing-configuration-files" class="anchor"></a>Parsing Configuration Files</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Config_parser"><a href="#module-Config_parser" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Config_parser/index.html">Config_parser</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Reader for configuration files for Beluga signatures.</p></div></div><h2 id="lexing"><a href="#lexing" class="anchor"></a>Lexing</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Token"><a href="#module-Token" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Token/index.html">Token</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Token definition for lexing.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Located_token"><a href="#module-Located_token" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Located_token/index.html">Located_token</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Lexer tokens annotated with locations.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Lexer"><a href="#module-Lexer" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Lexer/index.html">Lexer</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Tokenization of UTF-8 text input.</p></div></div><h2 id="parsing"><a href="#parsing" class="anchor"></a>Parsing</h2><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-PARSER_STATE"><a href="#module-type-PARSER_STATE" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> PARSER_STATE</span><span> = <a href="Parser_combinator/module-type-PARSER_STATE/index.html">Parser_combinator.PARSER_STATE</a></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Parser_combinator"><a href="#module-Parser_combinator" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Parser_combinator/index.html">Parser_combinator</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>General purpose parser combinator library.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Common_parser"><a href="#module-Common_parser" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Common_parser/index.html">Common_parser</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Common parser definitions for parsing Beluga signatures.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Lf_parser"><a href="#module-Lf_parser" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Lf_parser/index.html">Lf_parser</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Clf_parser"><a href="#module-Clf_parser" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Clf_parser/index.html">Clf_parser</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Meta_parser"><a href="#module-Meta_parser" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Meta_parser/index.html">Meta_parser</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Comp_parser"><a href="#module-Comp_parser" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Comp_parser/index.html">Comp_parser</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Harpoon_parser"><a href="#module-Harpoon_parser" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Harpoon_parser/index.html">Harpoon_parser</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Signature_parser"><a href="#module-Signature_parser" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Signature_parser/index.html">Signature_parser</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-PARSING"><a href="#module-type-PARSING" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-PARSING/index.html">PARSING</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Abstract definition of parsing for Beluga.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Make_parsing"><a href="#module-Make_parsing" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Make_parsing/index.html">Make_parsing</a></span><span>
  (<a href="Make_parsing/argument-1-Parser_state/index.html">Parser_state</a> : 
    <a href="Parser_combinator/module-type-PARSER_STATE/index.html">PARSER_STATE</a>
      <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="Parser_combinator/module-type-PARSER_STATE/index.html#type-token">token</a> = <a href="Located_token/index.html#type-t">Located_token.t</a></span>
       <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="Parser_combinator/module-type-PARSER_STATE/index.html#type-location">location</a> = <a href="../Syncom/Location/index.html#type-t">Beluga_syntax.Location.t</a></span>) : 
  <a href="module-type-PARSING/index.html">PARSING</a>
    <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-PARSING/index.html#type-state">state</a> = <a href="Make_parsing/argument-1-Parser_state/index.html#type-state">Parser_state.state</a></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="module-type-PARSING/index.html#type-token">token</a> = <a href="Make_parsing/argument-1-Parser_state/index.html#type-token">Parser_state.token</a></span>
     <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="module-type-PARSING/index.html#type-location">location</a> = <a href="Make_parsing/argument-1-Parser_state/index.html#type-location">Parser_state.location</a></span></span></code></div><div class="spec-doc"><p>Functor creating a Beluga parser using the given implementation of state.</p></div></div><h2 id="disambiguation"><a href="#disambiguation" class="anchor"></a>Disambiguation</h2><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-DISAMBIGUATION_STATE"><a href="#module-type-DISAMBIGUATION_STATE" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> DISAMBIGUATION_STATE</span><span> = <a href="Disambiguation_state/module-type-DISAMBIGUATION_STATE/index.html">Disambiguation_state.DISAMBIGUATION_STATE</a></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Disambiguation_state"><a href="#module-Disambiguation_state" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Disambiguation_state/index.html">Disambiguation_state</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Definition and implementation of the state required to disambiguate the Beluga syntax from the parser AST to the external AST.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Application_disambiguation"><a href="#module-Application_disambiguation" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Application_disambiguation/index.html">Application_disambiguation</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Disambiguation of expression applications with user-defined operators and juxtapositions.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Lf_disambiguation"><a href="#module-Lf_disambiguation" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Lf_disambiguation/index.html">Lf_disambiguation</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Clf_disambiguation"><a href="#module-Clf_disambiguation" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Clf_disambiguation/index.html">Clf_disambiguation</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Meta_disambiguation"><a href="#module-Meta_disambiguation" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Meta_disambiguation/index.html">Meta_disambiguation</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Comp_disambiguation"><a href="#module-Comp_disambiguation" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Comp_disambiguation/index.html">Comp_disambiguation</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Harpoon_disambiguation"><a href="#module-Harpoon_disambiguation" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Harpoon_disambiguation/index.html">Harpoon_disambiguation</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Signature_disambiguation"><a href="#module-Signature_disambiguation" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Signature_disambiguation/index.html">Signature_disambiguation</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-DISAMBIGUATION"><a href="#module-type-DISAMBIGUATION" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-DISAMBIGUATION/index.html">DISAMBIGUATION</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Abstract definition of disambiguation for Beluga.</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Make_disambiguation"><a href="#module-Make_disambiguation" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Make_disambiguation/index.html">Make_disambiguation</a></span><span>
  (<a href="Make_disambiguation/argument-1-Disambiguation_state/index.html">Disambiguation_state</a> : <a href="Disambiguation_state/module-type-DISAMBIGUATION_STATE/index.html">DISAMBIGUATION_STATE</a>) : 
  <a href="module-type-DISAMBIGUATION/index.html">DISAMBIGUATION</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-DISAMBIGUATION/index.html#type-state">state</a> = <a href="Make_disambiguation/argument-1-Disambiguation_state/index.html#type-state">Disambiguation_state.state</a></span></span></code></div><div class="spec-doc"><p>Functor creating a Beluga disambiguator using the given implementation of state.</p></div></div><h2 id="constructors_4"><a href="#constructors_4" class="anchor"></a>Constructors</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Make"><a href="#module-Make" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Make/index.html">Make</a></span><span>
  (<a href="Make/argument-1-Parser_state/index.html">Parser_state</a> : 
    <a href="Parser_combinator/module-type-PARSER_STATE/index.html">PARSER_STATE</a>
      <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="Parser_combinator/module-type-PARSER_STATE/index.html#type-token">token</a> = <a href="Located_token/index.html#type-t">Located_token.t</a></span>
       <span class="keyword">and</span> <span><span class="keyword">type</span> <a href="Parser_combinator/module-type-PARSER_STATE/index.html#type-location">location</a> = <a href="../Syncom/Location/index.html#type-t">Beluga_syntax.Location.t</a></span>)
  (<a href="Make/argument-2-Disambiguation_state/index.html">Disambiguation_state</a> : <a href="Disambiguation_state/module-type-DISAMBIGUATION_STATE/index.html">DISAMBIGUATION_STATE</a>) : 
  <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h2 id="instances_10"><a href="#instances_10" class="anchor"></a>Instances</h2><div class="odoc-spec"><div class="spec module anchored" id="module-Parser"><a href="#module-Parser" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Parser/index.html">Parser</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div></div></body></html>