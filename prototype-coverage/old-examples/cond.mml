(* This example will not typecheck until you implement subtyping *)

let fun nonnegative (x : int) : bool = ~1 < x
    fun positive (x : int) : bool = 0 < x
    val dumb = 3 : int|positive
(*    val yaaa = ~6 : int|positive *)
    fun fact : (int | nonnegative) -> (int | positive) (x) =
      if x = 0 then 1
      else x * fact(x - 1)
(*   val bad_call = fact ~5 *)
in
  (fact 5) : (int | fn n => n = 120)
end;
