This function is total, but it is not recursive.
